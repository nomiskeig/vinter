commands:
  trace_cmd_prefix: 'mkdir /home/ && mkdir /home/simon && mkdir /lib/modules/ && mkdir /lib/modules/5.1.0+ && mv /bin/tracer_module.ko /lib/modules/5.1.0+ && depmod && ls /lib/modules/5.1.0+ && ls /dev/pmem* &&  mount -tNOVA -oinit /dev/pmem0 /mnt && sync'
  recovery_cmd: 'mount -oro -tNOVA /dev/pmem0 /mnt && ls -lah /mnt && ( [ ! -f /mnt/myfile ] || cat /mnt/myfile ) && fs-dump --contents /mnt > /dev/null && hypercall success'
  dump_cmd_prefix: 'mount -oro -tNOVA /dev/pmem0 /mnt && fs-dump --contents /mnt && umount /mnt && mount -tNOVA /dev/pmem0 /mnt'
vm:
  pmem_start: 134217728 # 128 * 2**20
  pmem_len: 5242880 # 5 * 2**20
  mem: '134M'
  prompt: '(/ # |.*---\[ end trace )' # note that the latter cuts of a bit from kernel stack traces, but we can live with that. Put everything in brackets because panda_expect.py runs `self.expectation_ends_re = re.compile(r'(.*)' + expectation)` and uses the first group
  qemu_args: [
    
    '-cpu', 'max,fsgsbase=off', # enable clwb, clflushopt
  #'-object' , 'memory-backend-file,id=mem1,share,mem-path=./virtio_pmem.img,size=4G',
  #  '-device', 'virtio-pmem-pci,memdev=mem1,id=nv1,memaddr=0x140000000',
    '-append', 'console=ttyS0,115200n8 memmap=5M!128M memmap=123M!133M memmap=128M!258M'
    # ^ kernel enforces alignment at 128 MiB (https://elixir.bootlin.com/linux/v5.1/source/kernel/memremap.c#L157), and within one 128 MiB block, it may not overlap with other memory such as system RAM for it to be mapped as /dev/pmem0 (https://elixir.bootlin.com/linux/v5.1/source/kernel/memremap.c#L180).
  ]
  kernel: '../linux/MPKTracerNova_build/arch/x86/boot/bzImage'
  initrd: '../initramfs/initramfs_mpk.cpio.gz'
  system_map: '../linux/MPKTracerNova_build/System.map'
